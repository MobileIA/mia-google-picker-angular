!function(){"use strict";function miaGooglePickerSettingProvider(){function e(e){return{apiKey:this.apiKey,clientId:this.clientId,scopes:this.scopes,features:this.features,views:this.views,locale:this.locale,origin:this.origin||e.location.protocol+"//"+e.location.host}}this.apiKey=null,this.clientId=null,this.scopes=["https://www.googleapis.com/auth/drive.file"],this.features=["MULTISELECT_ENABLED"],this.views=["DocsView().setIncludeFolders(true)","DocsUploadView().setIncludeFolders(true)"],this.locale="en",this.configure=function(e){for(var i in e)this[i]=e[i]},this.$get=e,e.$inject=["$window"]}function miaGooglePicker(miaGooglePickerSetting){return{restrict:"A",scope:{onLoaded:"&",onCancel:"&",onPicked:"&"},link:function(scope,element){function instanciate(){gapi.load("auth",{callback:onApiAuthLoad}),gapi.load("picker")}function onApiAuthLoad(){var e=gapi.auth.getToken();e?handleAuthResult(e):gapi.auth.authorize({client_id:miaGooglePickerSetting.clientId,scope:miaGooglePickerSetting.scopes,immediate:!1},handleAuthResult)}function handleAuthResult(e){e&&!e.error&&(accessToken=e.access_token,openPicker())}function openPicker(){var picker=(new google.picker.PickerBuilder).setLocale(miaGooglePickerSetting.locale).setDeveloperKey(miaGooglePickerSetting.apiKey).setOAuthToken(accessToken).setCallback(pickerResponse).setOrigin(miaGooglePickerSetting.origin);miaGooglePickerSetting.features.length>0&&angular.forEach(miaGooglePickerSetting.features,function(e,i){picker.enableFeature(google.picker.Feature[e])}),miaGooglePickerSetting.views.length>0&&angular.forEach(miaGooglePickerSetting.views,function(view,key){view=eval("new google.picker."+view),picker.addView(view)}),picker.build().setVisible(!0)}function pickerResponse(e){e.action==google.picker.Action.LOADED&&scope.onLoaded&&(scope.onLoaded||angular.noop)(),e.action==google.picker.Action.CANCEL&&scope.onCancel&&(scope.onCancel||angular.noop)(),e.action==google.picker.Action.PICKED&&scope.onPicked&&(scope.onPicked||angular.noop)({docs:e.docs}),scope.$apply()}var accessToken=null;element.bind("click",function(e){instanciate()})}}}angular.module("miaGooglePicker",[]).provider("miaGooglePickerSetting",miaGooglePickerSettingProvider).directive("miaGooglePicker",miaGooglePicker),miaGooglePicker.$inject=["miaGooglePickerSetting"]}();